<!DOCTYPE html>
<html lang="en">
<head>
    <script defer src="https://loopaware.mprlab.com/widget.js?site_id=d8c3d1c8-7968-43d0-8026-ee827ada7666"></script>
    <script defer src="https://tauth.mprlab.com/tauth.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@latest/mpr-ui-config.js"></script>
    <script>
        (function() {
            function loadMprUi() {
                return new Promise((resolve, reject) => {
                    const script = document.createElement("script");
                    script.src = "https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@latest/mpr-ui.js";
                    script.addEventListener("load", () => resolve(), { once: true });
                    script.addEventListener("error", () => reject(new Error("mpr_ui.load_failed")), { once: true });
                    document.head.appendChild(script);
                });
            }

            function primeNonce() {
                if (typeof window.requestNonce !== "function") {
                    throw new Error("tauth.requestNonce_missing");
                }
                const originalRequest = window.requestNonce.bind(window);
                let cachedNonce = null;
                let inFlightPromise = null;
                window.requestNonce = async () => {
                    if (cachedNonce) {
                        const value = cachedNonce;
                        cachedNonce = null;
                        return value;
                    }
                    if (inFlightPromise) {
                        const value = await inFlightPromise;
                        if (cachedNonce) {
                            const cachedValue = cachedNonce;
                            cachedNonce = null;
                            return cachedValue;
                        }
                        return value;
                    }
                    return originalRequest();
                };
                inFlightPromise = originalRequest().then((nonce) => {
                    cachedNonce = nonce;
                    return nonce;
                });
                return inFlightPromise;
            }

            function initializeAuth(runtimeConfig) {
                if (!runtimeConfig || !runtimeConfig.auth) {
                    throw new Error("mpr_ui.config_missing");
                }
                if (typeof window.initAuthClient !== "function") {
                    throw new Error("tauth.initAuthClient_missing");
                }
                return Promise.resolve(window.initAuthClient({
                    baseUrl: runtimeConfig.auth.tauthUrl,
                    tenantId: runtimeConfig.auth.tenantId,
                    onAuthenticated: () => {},
                    onUnauthenticated: () => {}
                })).then(primeNonce);
            }

            function start() {
                if (!window.MPRUI || typeof window.MPRUI.applyYamlConfig !== "function") {
                    throw new Error("mpr_ui.config_loader_missing");
                }
                const configUrl = typeof window.__mprUiConfigUrl === "string" && window.__mprUiConfigUrl.length > 0
                    ? window.__mprUiConfigUrl
                    : "/config.yaml";
                window.__mprUiReady = window.MPRUI.applyYamlConfig({ configUrl })
                    .then((runtimeConfig) => initializeAuth(runtimeConfig).then(() => runtimeConfig))
                    .then(loadMprUi);
            }

            if (document.readyState === "loading") {
                document.addEventListener("DOMContentLoaded", start, { once: true });
            } else {
                start();
            }
        })();
    </script>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="data:image/png;base64,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"
    />
    <link
            rel="shortcut icon"
            type="image/png"
            sizes="32x32"
            href="data:image/png;base64,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"
    />
    <title>Gravity Notes</title>

    <!-- Markdown renderer -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.2/marked.min.js"></script>

    <!-- HTML sanitizer -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.7/dist/purify.min.js"></script>

    <!-- Markdown editor -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde@2.19.0/dist/easymde.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/easymde@2.19.0/dist/easymde.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/MarcoPoloResearchLab/mpr-ui@latest/mpr-ui.css"/>
    <link rel="stylesheet" href="./styles.css?build=2026-01-01T22:43:21Z"/>
</head>
<body x-data="gravityApp()" data-auth-state="loading">
<section class="landing" x-ref="landingView" data-test="landing">
    <div class="landing-shell">
        <div class="landing-copy">
            <div class="landing-kicker" x-text="constants.LABEL_APP_TITLE">Gravity Notes</div>
            <h1 class="landing-title" x-text="constants.LABEL_LANDING_TITLE">Notes that stay anchored.</h1>
            <p class="landing-description" x-text="constants.LABEL_LANDING_DESCRIPTION"></p>
            <div class="landing-actions">
                <mpr-login-button id="landing-login" class="landing-login" x-ref="landingLogin" data-test="landing-login"></mpr-login-button>
                <p class="landing-hint" x-text="constants.LABEL_LANDING_SIGN_IN_HINT"></p>
            </div>
            <div class="landing-status" x-ref="landingStatus" data-test="landing-status" hidden></div>
        </div>
        <div class="landing-visual" aria-hidden="true">
            <div class="landing-card landing-card--primary"></div>
            <div class="landing-card landing-card--secondary"></div>
            <div class="landing-card landing-card--tertiary"></div>
        </div>
    </div>
    <footer class="landing-footer">
        <a class="app-legal-link" href="/privacy" x-text="constants.LABEL_PRIVACY_TERMS_LINK">Privacy • Terms</a>
    </footer>
</section>

<div class="app-shell" x-ref="appShell" data-test="app-shell" hidden>
    <header class="app-header">
        <div class="app-branding">
            <h1 class="app-title" x-text="constants.LABEL_APP_TITLE">Gravity Notes</h1>
            <div class="app-subtitle" x-text="constants.LABEL_APP_SUBTITLE">Append anywhere · Bubble to top · Auto-organize</div>
        </div>
        <div class="app-auth">
            <button
                    class="fullscreen-toggle"
                    type="button"
                    x-ref="fullScreenToggle"
                    data-test="fullscreen-toggle"
                    data-fullscreen-state="enter"
                    aria-pressed="false"
                    aria-label=""
                    title=""
            >
                <svg class="fullscreen-toggle__icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <g class="fullscreen-toggle__enter">
                        <path class="fullscreen-toggle__stroke" d="M6 18 L18 6"/>
                        <path class="fullscreen-toggle__stroke" d="M6 12 L6 18 L12 18"/>
                        <path class="fullscreen-toggle__stroke" d="M18 12 L18 6 L12 6"/>
                    </g>
                    <g class="fullscreen-toggle__exit">
                        <path class="fullscreen-toggle__stroke" d="M6 6 L18 18"/>
                        <path class="fullscreen-toggle__stroke" d="M7.5 5 L6 6 L5 7.5"/>
                        <path class="fullscreen-toggle__stroke" d="M19 16.5 L18 18 L16.5 19"/>
                    </g>
                </svg>
                <span class="fullscreen-toggle__label" data-role="fullscreen-label" x-text="constants.LABEL_ENTER_FULL_SCREEN">Full Screen</span>
            </button>
            <mpr-user
                    id="app-user-menu"
                    x-ref="userMenu"
                    data-test="user-menu"
                    display-mode="avatar-name"
                    logout-url="/"
                    logout-label="Sign out"
            ></mpr-user>
        </div>
    </header>

    <button id="export-notes-button" class="app-hidden-button" type="button" x-ref="exportButton" hidden></button>
    <button id="import-notes-button" class="app-hidden-button" type="button" x-ref="importButton" hidden></button>
    <input id="import-notes-input" x-ref="importInput" type="file" hidden />

    <!-- Structural, always-empty editor (never persisted) -->
    <section id="top-editor"></section>

    <!-- Persisted notes list -->
    <main id="notes-container" x-ref="notesContainer" class="block-container"></main>

    <div id="editor-toast" class="toast" aria-live="polite" hidden></div>
    <div id="editor-save-status" class="sr-only" aria-live="polite"></div>

    <footer class="app-footer">
        <a class="app-legal-link" href="/privacy" x-text="constants.LABEL_PRIVACY_TERMS_LINK">Privacy • Terms</a>
    </footer>
</div>

<script type="module" src="./js/app.js?build=2026-01-01T22:43:21Z"></script>
</body>
</html>
